
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avatar Display Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .avatar-test {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 10px;
            display: inline-block;
            border: 2px solid #e8f24c;
            object-fit: cover;
        }
        .avatar-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üñºÔ∏è Avatar Display Test</h1>
    
    <div class="test-container">
        <h2>1. Direct Image Loading Test</h2>
        <div id="direct-test"></div>
    </div>

    <div class="test-container">
        <h2>2. Relative Path Test</h2>
        <div id="relative-test"></div>
    </div>

    <div class="test-container">
        <h2>3. Absolute URL Test</h2>
        <div id="absolute-test"></div>
    </div>

    <div class="test-container">
        <h2>4. Chatbot Widget Avatar Test</h2>
        <div id="widget-test"></div>
    </div>

    <div class="test-container">
        <h2>üìã Test Results</h2>
        <div id="results"></div>
    </div>

    <script>
        const avatarNames = ['sarah.jpg', 'alex.jpg', 'emma.jpg', 'mike.jpg'];
        const baseUrl = window.location.origin;
        const results = [];

        function logResult(test, status, message) {
            results.push({test, status, message});
            updateResults();
        }

        function updateResults() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = results.map(r => 
                `<div class="status ${r.status}">${r.test}: ${r.message}</div>`
            ).join('');
        }

        function testImageLoad(src, container, testName) {
            return new Promise((resolve) => {
                const img = document.createElement('img');
                img.className = 'avatar-test';
                img.alt = testName;
                
                const avatarContainer = document.createElement('div');
                avatarContainer.className = 'avatar-container';
                
                const label = document.createElement('span');
                label.textContent = `${testName}: ${src.substring(0, 50)}...`;
                
                img.onload = () => {
                    logResult(testName, 'success', 'Loaded successfully');
                    avatarContainer.innerHTML = `<span>‚úÖ ${testName}</span>`;
                    resolve(true);
                };
                
                img.onerror = () => {
                    logResult(testName, 'error', 'Failed to load');
                    avatarContainer.innerHTML = `<span>‚ùå ${testName}</span>`;
                    resolve(false);
                };
                
                img.src = src;
                avatarContainer.appendChild(img);
                avatarContainer.appendChild(label);
                container.appendChild(avatarContainer);
            });
        }

        async function runTests() {
            const directContainer = document.getElementById('direct-test');
            const relativeContainer = document.getElementById('relative-test');
            const absoluteContainer = document.getElementById('absolute-test');
            const widgetContainer = document.getElementById('widget-test');

            // Test 1: Direct paths
            for (const avatar of avatarNames) {
                await testImageLoad(`images/avatars/${avatar}`, directContainer, `Direct-${avatar}`);
            }

            // Test 2: Relative paths with ./
            for (const avatar of avatarNames) {
                await testImageLoad(`./images/avatars/${avatar}`, relativeContainer, `Relative-${avatar}`);
            }

            // Test 3: Absolute URLs
            for (const avatar of avatarNames) {
                await testImageLoad(`${baseUrl}/images/avatars/${avatar}`, absoluteContainer, `Absolute-${avatar}`);
            }

            // Test 4: Widget-style loading
            const widgetAvatar = `${baseUrl}/images/avatars/sarah.jpg`;
            const widgetImg = document.createElement('img');
            widgetImg.className = 'avatar-test';
            widgetImg.style.objectFit = 'cover';
            widgetImg.style.display = 'block';
            widgetImg.style.backgroundColor = '#e8f24c';
            
            widgetImg.onload = () => {
                logResult('Widget Style', 'success', 'Widget-style avatar loaded');
                widgetContainer.innerHTML = '<span>‚úÖ Widget-style avatar works</span>';
            };
            
            widgetImg.onerror = () => {
                logResult('Widget Style', 'error', 'Widget-style avatar failed');
                widgetContainer.innerHTML = '<span>‚ùå Widget-style avatar failed</span>';
            };
            
            widgetImg.src = widgetAvatar;
            widgetContainer.appendChild(widgetImg);

            // Network test
            try {
                const response = await fetch(`${baseUrl}/images/avatars/sarah.jpg`);
                logResult('Network Test', response.ok ? 'success' : 'error', 
                    `HTTP ${response.status} - ${response.statusText}`);
            } catch (error) {
                logResult('Network Test', 'error', error.message);
            }
        }

        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>
