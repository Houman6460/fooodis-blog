<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Test Page</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a2e; color: #fff; }
        .post-card { background: #16213e; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .post-title { color: #e8f24c; margin: 0 0 10px 0; }
        .post-excerpt { color: #aaa; }
        .error { color: #ff6b6b; }
        .success { color: #4ecdc4; }
        #log { background: #0f0f23; padding: 10px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>Blog API Test</h1>
    <div id="log"></div>
    <h2>Posts:</h2>
    <div id="posts"></div>

    <script>
        const log = (msg, type = 'info') => {
            const logEl = document.getElementById('log');
            const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#4ecdc4' : '#fff';
            logEl.innerHTML += `<div style="color:${color}">[${new Date().toLocaleTimeString()}] ${msg}</div>`;
            console.log(msg);
        };

        async function testBlogAPI() {
            log('Starting blog API test...');
            
            try {
                log('Fetching /api/blog/posts?status=published...');
                const response = await fetch('/api/blog/posts?status=published');
                log(`Response status: ${response.status}`);
                
                if (!response.ok) {
                    log(`API error: ${response.status} ${response.statusText}`, 'error');
                    return;
                }
                
                const data = await response.json();
                log(`Raw response keys: ${Object.keys(data).join(', ')}`, 'success');
                
                const posts = data.posts || [];
                log(`Found ${posts.length} posts`, 'success');
                
                const postsEl = document.getElementById('posts');
                
                if (posts.length === 0) {
                    postsEl.innerHTML = '<p class="error">No posts found in database!</p>';
                    return;
                }
                
                posts.forEach((post, i) => {
                    log(`Post ${i+1}: "${post.title}" (status: ${post.status}, id: ${post.id})`);
                    postsEl.innerHTML += `
                        <div class="post-card">
                            <h3 class="post-title">${post.title}</h3>
                            <p class="post-excerpt">${post.excerpt || post.content?.substring(0, 100) || 'No content'}</p>
                            <small>Category: ${post.category} | Status: ${post.status} | ID: ${post.id}</small>
                        </div>
                    `;
                });
                
                log('Test complete!', 'success');
                
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // Run test when page loads
        testBlogAPI();
    </script>
</body>
</html>
